<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Find id</title>
    <link
      rel="stylesheet"
      href="./findId.css"
    />
  </head>
  <body>
    <main id="main-container">
      <header id="find-Id-header">
        <img src="../assets/images/logo.png" />
        <h1>
          <a href="http://dongnaecomm.cafe24app.com">우리 동네 대동단결</a>
        </h1>
      </header>
      <section id="find-Id-form">
        <h2>아이디 찾기</h2>
        <form id="find-Id-form-field">
          <input
            placeholder="이름 입력해주세요."
            type="text"
          />
          <input
            placeholder="닉네임을 입력해주세요."
            type="text"
          />
          <button type="submit">찾기</button>
          <a
            id="find-Id-link"
            href="./login.html"
            >로그인하러 가기</a
          >
        </form>
      </section>
    </main>
  </body>
  <script>
    const findIdForm = document.querySelector("#find-Id-form-field");

    findIdForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = e.target[0].value;
      const nickname = e.target[1].value;
      if (name === "" || nickname === "") {
        alert("이름과 닉네임을 입력해주세요.");
        return;
      }
      const res = await fetch(
        "http://dongnaecomm.cafe24app.com/api/user/findId",
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            name,
            nickname,
          }),
        }
      );
      const data = await res.json();
      if (data.success) {
        alert(`아이디는 ${data.email} 입니다.`);
        location.href = "./login.html";
      } else {
        alert(data.message);
      }
    });
  </script>
</html>
